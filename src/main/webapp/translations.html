<!DOCTYPE html>
<html ng-app="app">
<head>
	<meta charset="UTF-8">
	<title>OSM translations tool</title>
	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.1/angular.js"></script>
	<script src="//cdn.jsdelivr.net/angular.xeditable/0.1.9/js/xeditable.js"></script>
	<link href="//cdn.jsdelivr.net/angular.xeditable/0.1.9/css/xeditable.css" type="text/css" rel="StyleSheet">
	<link href="css/app.css" type="text/css" rel="StyleSheet">
	<script src="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet-src.js" type="text/javascript"></script>
	<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css"></link>
	<script src="js/osmauth.js"></script>
	<script src="js/app.js"></script>
	<script src="js/osm.js"></script>
</head>
<body ng-controller="tableCtrl">
	<select ng-model="type"  ng-change="updatePage();">
		<option value="admbnd" title="Границы">Границы</option>
		<option value="plcpnt" title="Города">Города</option>
		<option value="hghway" title="Улицы">Улицы</option>
	</select>
	<input type="text" placeholder="Название" ng-model="name">
	<input type="text" placeholder="Страна" ng-model="country">
	<input type="text" placeholder="Город" ng-model="city">
	<button ng-click="updatePage();">Filter</button>
	
	<div class="clear-fix"></div>
	
	<table class="page" ng-show="page">
		<thead>
			<tr>
				<td>id</td>
				<td>type</td>
				<td>name</td>
				<td ng-repeat="lang in page.langs" ng-bind="lang"></td>
			</tr>
		</thead>
		<tr ng-repeat="row in page.rows">
			<td ng-bind="row.id"></td>
			<td ng-bind="row.type"></td>
			<td ng-bind="row.name"></td>
			<td ng-repeat="lang in page.langs" class="edit">
				<div editable-text="row.translations[lang]" ng-click="updateMap(row);" 
					onbeforesave="saveRow(row, lang, $data)"
					ng-bind="row.translations[lang] || 'empty'"></div>
			</td>
		</tr>
	</table>
	<div id="map"></div>
	<div id="user-info">
		<div ng-show="osmLogin">You are logged as: {{osmLogin}}</div>
		<div ng-hide="osmLogin">You are not logged in</div>
		<button ng-hide="osmLogin" ng-click="authentificate();">Login in OSM</button>
		<button ng-click="logout();">Logout</button>
	</div>
	<div id="changes" ng-show="merged4Save">
		<span>Изменений: </span><span ng-bind="countChanges();"></span>
		<input type="text" placeholder="Коментарии к правкам" 
			style="width: 400px;" ng-model="changesetComment"></input>
		<div ng-bind="saveState"></div>
		<a ng-show="savedChangesetId" href="http://openstreetmap.org/changeset/{{savedChangesetId}}">Chaingeset {{savedChangesetId}}</a>
		<button ng-show="changesetComment && osmLogin" ng-click="$broadcast('save');">Save to OSM</button>
	</div>
	<div class="clear-fix"></div>
	<div id="pager">
		<a class="page" ng-class="{curentpage: pg.active, spaceleft: pg.spaceLeft, spaceright: pg.spaceRight}" 
			ng-repeat="pg in srPages" ng-bind="pg.p" ng-click="goPage(pg)"></a>
	</div>

	<button ng-hide="saved" ng-click="$broadcast('merge');">Merge</button>

</body>
</html>